 https://www.dmosk.ru/instruktions.php?object=prometheus-linux#node-autoruns



 firewall-cmd --permanent --add-port={9090,9093,9094,9100}/tcp --add-port=9094/udp
 firewall-cmd --reload
 firewall-cmd --list-all
 wget https://github.com/prometheus/prometheus/releases/download/v2.19.1/prometheus-2.19.1.linux-amd64.tar.gz
 mkdir /etc/prometheus
 mkdir /var/lib/prometheus
 tar zxvf prometheus-2.19.1.linux-amd64.tar.gz
 cd prometheus-2.19.1.linux-amd64
 cp prometheus promtool /usr/local/bin/
 cp -r console_libraries consoles prometheus.yml /etc/prometheus/
 ls -al /etc/prometheus/
 ls -al /usr/local/bin/ | grep prom
 useradd --no-create-home --shell /bin/false prometheus
 chown -R prometheus:prometheus /etc/prometheus /var/lib/prometheus/
 chown prometheus:prometheus /usr/local/bin/{prometheus,promtool}
 /usr/local/bin/prometheus --config.file /etc/prometheus/prometheus.yml --storage.tsdb.path /var/lib/prometheus/ --web.console.templates=/etc/prometheus/consoles --web.console.libraries=/etc/prometheus/console_libraries
 vi /etc/systemd/system/prometheus.service
 systemctl daemon-reload
 systemctl enable prometheus
 chown -R prometheus:prometheus /var/lib/prometheus
 systemctl start prometheus
 systemctl status prometheus
 wget https://github.com/prometheus/alertmanager/releases/download/v0.21.0/alertmanager-0.21.0.linux-amd64.tar.gz
 mkdir /etc/alertmanager /var/lib/prometheus/alertmanager
 tar zxvf alertmanager-*.linux-amd64.tar.gz
 cd alertmanager-*.linux-amd64
 cp alertmanager amtool /usr/local/bin/
 cp alertmanager.yml /etc/alertmanager/
 useradd --no-create-home --shell /bin/false alertmanager
 chown -R alertmanager:alertmanager /etc/alertmanager/ /var/lib/prometheus/alertmanager/
 chown alertmanager:alertmanager /usr/local/bin/{alertmanager,amtool}
 vi /etc/systemd/system/alertmanager.service
 systemctl daemon-reload
 systemctl enable alertmanager
 systemctl start alertmanager
 systemctl status alertmanager
 wget https://github.com/prometheus/node_exporter/releases/download/v1.0.1/node_exporter-1.0.1.linux-amd64.tar.gz
 tar zxvf node_exporter-*.linux-amd64.tar.gz
 cd node_exporter-*.linux-amd64
 useradd --no-create-home --shell /bin/false nodeusr
 chown -R nodeusr:nodeusr /usr/local/bin/node_exporter
 chown -R nodeusr:nodeusr /usr/local/bin/node_exporter
 vi /etc/systemd/system/node_exporter.service
 systemctl daemon-reload
 systemctl enable node_exporter
 systemctl start node_exporter
 systemctl status node_exporter
 vi /etc/prometheus/prometheus.yml
 systemctl restart prometheus
 vi /etc/prometheus/prometheus.yml
 systemctl restart prometheus
 vi /etc/prometheus/alert.rules.yml
 vi /etc/prometheus/prometheus.yml
 systemctl restart prometheus

-----------------------------------------------

/etc/prometheus/prometheus.yml

global:
	scrape_interval: 15s	# как часто опрашивать exporter-ы

storage:
	tsdb:
	  path: /var/lib/prometheus # где хранить данные
	  retention:
	    time: 15d	# как долго хранить данные

scrape_configs:
	- job_name: 'prometheus'
	  static_configs:
	    - targets: ['localhost:9090']
	- job_name: 'app'
	  static_configs:
	    - targets: ['localhost:9100', 'localhost:9102', 'localhost:9103', 'localhost:9187']

